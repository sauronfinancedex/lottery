(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{52837:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return t(67789)}])},67789:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ke}});var s=t(47568),a=t(26042),o=t(34051),i=t.n(o),r=t(85893),c=t(214),l=t.n(c),d=t(44423),u=t(11163),h=[{id:"index",title:"Home",link:"index"},{id:"settings",title:"Settings",link:"settings",adminOnly:!0}],f=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,u.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("nav",{className:"".concat(l().mainNav," headerNavMenu"),children:h.map((function(t){return t.adminOnly&&!n?null:(0,r.jsx)("a",{className:e===t.id?"".concat(l().active," headerNavActive"):"",href:(0,d.R)(t.link),children:t.title},t.id)}))}),(0,r.jsx)("div",{className:l().mainNavSeperator})]})},m=t(14924),v=t(69396),x=t(67294),g=t(25364),p=t(73848),j=t(99603),b=t(59417);function y(e){var n=e.icon,t="fa-".concat(n).replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,n){return 0===n?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"").replaceAll("-","");return(0,r.jsx)(j.G,{icon:b[t]})}function w(e){var n=(0,a.Z)({onToggle:function(){}},e),t=n.title,s=n.isOpened,o=n.content,i=n.onToggle,c=n.key;return(0,r.jsxs)("div",{className:"".concat(l().adminToggleGroup," ").concat(s?l().adminToggleGroupOpened:""),children:[(0,r.jsxs)("div",{className:l().adminToggleGroupHeader,onClick:function(){i(!s)},children:[(0,r.jsx)("h3",{children:t}),(0,r.jsx)("a",{children:(0,r.jsx)(y,{icon:s?"arrow-up":"arrow-down"})})]}),s&&(0,r.jsx)("div",{className:l().adminToggleGroupContent,children:o})]},c)}var k=t(52484),S=t(82670),N=t(66089),C=t.n(N),T=t(78967),I=t(64262),F=t(34617);function A(e){var n=(0,a.Z)({hasClose:!1,onClose:function(){}},e),t=n.title,s=n.isOpened,o=n.hasClose,i=n.onClose,c=n.children;return s?(0,r.jsx)("div",{className:l().adminPopupWindow,children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{children:[t,o&&(0,r.jsx)("a",{onClick:i,children:(0,r.jsx)(y,{icon:"close"})})]}),c]})}):null}function D(e){var n=(0,a.Z)({disabled:!1,chainId:1,className:"",action:"Save",onClick:function(){}},e),t=n.children,s=n.disabled,o=n.onClick,i=n.chainId,c=n.action,d=n.className,u=n.icon,h=(0,x.useState)(!1),f=h[0],m=h[1],v=(0,F.n)().storageChainId,g="STORAGE"==i?v:i,p=(0,x.useState)(!1),j=p[0],b=p[1],w=(0,T.BV)(),k=(0,S.Z)(g,Array),N=!k&&(0,I.T_)(g),D=!1;D=k?-1!==g.indexOf(Number("".concat(w))):"".concat(g)=="".concat(w);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{disabled:s||j,onClick:function(){D?o():k?m(!0):(b(!0),(0,T.M5)(g).then((function(e){b(!1),e&&o()})).catch((function(e){b(!1)})))},className:d,children:[u&&(0,r.jsx)(y,{icon:u}),D?(0,r.jsx)(r.Fragment,{children:t}):(0,r.jsx)(r.Fragment,{children:j?(0,r.jsx)(r.Fragment,{children:k?"Switching...":"Switching to ".concat(N.chainName," (").concat(g,")...")}):(0,r.jsx)(r.Fragment,{children:k?"Switch network for ".concat(c):"Switch to ".concat(N.chainName," (").concat(g,") for ").concat(c)})})]}),k&&(0,r.jsxs)(A,{hasClose:!0,isOpened:f,onClose:function(){m(!1)},title:"Switch network for ".concat(c),children:[(0,r.jsx)(C(),{id:"4d48721f3162f416",children:".switchNetworkList.jsx-4d48721f3162f416{padding:10px;padding-bottom:0px}.switchNetworkList.jsx-4d48721f3162f416 BUTTON.jsx-4d48721f3162f416{margin-left:0px;width:100%;margin-bottom:10px}"}),(0,r.jsx)("div",{className:"jsx-4d48721f3162f416 switchNetworkList",children:g.map((function(e){var n=(0,I.T_)(e);return(0,r.jsx)("button",{disabled:j,onClick:function(){!function(e){b(!0),(0,T.M5)(e).then((function(e){b(!1),e&&(m(!1),o())})).catch((function(e){b(!1)}))}(e)},className:"jsx-4d48721f3162f416 "+(l().adminButton||""),children:j?"Switching...":"Switch to ".concat(n.chainName," (").concat(e,")")},e)}))})]})]})}function B(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,o=(e.getActiveChain,e.storageDesign),i=localStorage.getItem("-lotery-preview-mode"),c=localStorage.getItem("-lotery-preview-design");try{c=JSON.parse(c),c=(0,a.Z)({},g.$,c)}catch(Z){c=g.$}var d=(0,x.useState)(null!==i),u=d[0],h=d[1],f=(0,a.Z)({},g.$,o);console.log("initialDesign",f);var j=(0,x.useState)(i?c:f),b=j[0],S=j[1],N=(0,x.useState)(!1),C=N[0],T=N[1];console.log(">>> designValues",b);var I=function(e){var n=e.title,t=e.target,s=e.defValue;return(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[n,":"]}),(0,r.jsx)("span",{children:(0,r.jsx)("div",{children:(0,r.jsx)(k.ZP,{initialValue:b[t]?b[t]:s,onChange:function(e){S((function(n){return(0,v.Z)((0,a.Z)({},n),(0,m.Z)({},"".concat(t),e.hex))}))},placement:"right"})})})]})},F=function(){t({title:"Switch to preview mode",message:"Switch to preview mode? You can look changes before save",onConfirm:function(){s("Preview mode on. Go to site for check it","success"),localStorage.setItem("-nft-stake-preview-mode",!0),localStorage.setItem("-nft-stake-preview-design",JSON.stringify(b)),h(!0)}})},A=function(){s("Preview mode turn off","success"),localStorage.removeItem("-nft-stake-preview-mode"),localStorage.removeItem("-nft-stake-preview-design"),h(!1)};(0,x.useEffect)((function(){u&&(localStorage.setItem("-nft-stake-preview-design",JSON.stringify(b)),localStorage.setItem("-nft-stake-preview-utx",(0,p.K)()))}),[b]);var B=function(){n({onBegin:function(){T(!0),A(),s("Confirm transaction for save changed design")},onReady:function(){T(!1),s("Design successfull saved","success")},onError:function(e){T(!1),s("Fail save design","error")},newData:{design:b}})},R=(0,x.useState)({}),O=R[0],L=R[1],E=function(e){L((function(n){return(0,v.Z)((0,a.Z)({},n),(0,m.Z)({},"".concat(e),!n[e]||!n[e]))}))};return{render:function(){return(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsx)("div",{className:l().adminSectionDescription,children:"This section is where you edit the appearance of your site."}),w({title:"Base color",isOpened:null===O||void 0===O?void 0:O.baseColors,onToggle:function(){E("baseColors")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Background color",target:"backgroundColor"}),I({title:"Text color",target:"baseTextColor"}),I({title:"Secondary",target:"baseSecondaryColor",defValue:"#7645D9"}),I({title:"Subtitle color",target:"baseSubTitleColor",defValue:"#452A7A"})]})})}),w({title:"Header settings",isOpened:null===O||void 0===O?void 0:O.headerSection,onToggle:function(){E("headerSection")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Section title color",target:"headerTitleColor"}),I({title:"Background color 1",target:"headerBgColor1",defValue:"#7645D9"}),I({title:"Background color 2",target:"headerBgColor2",defValue:"#452A7A"})]})})}),w({title:"Buy tickets section",isOpened:null===O||void 0===O?void 0:O.buyTicketsSection,onToggle:function(){E("buyTicketsSection")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Section title color",target:"buyTicketTitleColor"}),I({title:"Background color 1",target:"buyTicketBgColor1",defValue:"#7645D9"}),I({title:"Background color 2",target:"buyTicketBgColor2",defValue:"#5121B1"})]})})}),w({title:"Price section",isOpened:null===O||void 0===O?void 0:O.priceSection,onToggle:function(){E("priceSection")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Section title color",target:"priceSectionTitleColor"}),I({title:"Background color 1",target:"priceSectionBgColor1",defValue:"#313D5C"}),I({title:"Background color 2",target:"priceSectionBgColor2",defValue:"#3D2A54"})]})})}),w({title:"Rounds history section",isOpened:null===O||void 0===O?void 0:O.roundsHistory,onToggle:function(){E("roundsHistory")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Section title color",target:"roundsHistoryTitleColor"}),I({title:"Background color 1",target:"roundsHistoryBgColor1",defValue:"#CBD7EF"}),I({title:"Background color 2",target:"roundsHistoryBgColor2",defValue:"#9A9FD0"})]})})}),w({title:"How to play settings",isOpened:null===O||void 0===O?void 0:O.howToPlay,onToggle:function(){E("howToPlay")},content:(0,r.jsx)("div",{className:l().subFormInfo,children:(0,r.jsxs)("div",{className:l().subForm,children:[I({title:"Section title",target:"howToPlayTitleColor"}),I({title:"Background color",target:"howToPlayBgColor",defValue:"#ffffff"})]})})}),(0,r.jsx)("div",{className:l().adminSectionDescription,children:"You can turn on the preview mode and look at the changes before saving them to the storage contract"}),(0,r.jsxs)("div",{className:l().actionsRowMain,children:[u?(0,r.jsxs)("button",{onClick:A,className:l().adminSubButton,children:[(0,r.jsx)(y,{icon:"eye-slash"}),"Turn off preview mode"]}):(0,r.jsxs)("button",{onClick:F,className:l().adminSubButton,children:[(0,r.jsx)(y,{icon:"eye"}),"Turn on preview mode"]}),(0,r.jsx)(D,{chainId:"STORAGE",disabled:C,onClick:B,action:"Save changes",icon:"save",className:l().adminSubButton,children:C?"Saving...":"Save changes"})]})]})}}}var R=t(64914),O=t.n(R),L=t(3283),E=t.n(L),Z=function(e,n){return new Promise((function(t,s){var a=(0,I.T_)(n);if(a)try{var o=new(new(E())(a.rpcUrls[0]).eth.Contract)(O(),e);o.methods.decimals().call().then((function(a){o.methods.symbol().call().then((function(i){o.methods.name().call().then((function(s){t({address:e,chainId:n,decimals:a,symbol:i,name:s})})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))})).catch((function(e){s(e)}))}catch(i){s(i)}else s("NOT_SUPPORTED_CHAIN")}))},_=t(56767),P=t(44431),W=t.n(P),M=function(e){return new Promise((function(n,t){var a=e.activeWeb3,o=e.tokenAddress,r=e.feeOn;console.log(">>> options",e);var c=e.onTrx||function(){},l=e.onSuccess||function(){},d=e.onError||function(){},u=e.onFinally||function(){};a.eth.getAccounts().then(function(){var e=(0,s.Z)(i().mark((function e(n){var s,h,f,m,v,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n.length>0)){e.next=13;break}return s=n[0],h=new a.eth.Contract(_.Mt),f={from:s,gas:"0"},m=[o,!!r],e.next=7,h.deploy({arguments:m,data:_.aT.eF.Ry}).estimateGas(f);case 7:v=e.sent,x=new P.BigNumber(new P.BigNumber(v).multipliedBy(1.05).toFixed(0)).toString(16),f.gas="0x"+x,h.deploy({data:"0x"+_.aT.eF.Ry,arguments:m}).send(f).on("transactionHash",(function(e){console.log("transaction hash:",e),c(e)})).on("error",(function(e){console.log("transaction error:",e),d(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),l(e.contractAddress)})).then((function(){u()})),e.next=14;break;case 13:t("NO_ACTIVE_ACCOUNT");case 14:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log(">>> deployLottery",e),t(e)}))}))};function H(e){var n=e.type,t=e.label,s=e.value,a=e.onChange,o=e.buttons,i=e.values,c=e.placeholder,d=e.hasError,u=e.errorText,h=e.desc,f=n;if("address"===n)f="text";return(0,r.jsxs)("div",{className:"".concat(l().adminFormInputHolder," ").concat(d?l().hasError:""),children:["list"===n?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{children:[t,": (",s,")"]}),h&&(0,r.jsx)("span",{className:l().adminFieldDesc,children:h}),(0,r.jsxs)("div",{children:[d&&u&&(0,r.jsx)("span",{className:l().hasError,children:u}),(0,r.jsx)("select",{value:s,onChange:function(e){return a(e.target.value)},children:i.map((function(e){return(0,r.jsx)("option",{value:e.id,children:e.title},e.id)}))})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("label",{children:[t,":"]}),h&&(0,r.jsx)("span",{className:l().adminFieldDesc,children:h}),d&&u&&(0,r.jsx)("span",{className:l().hasError,children:u}),(0,r.jsx)("div",{children:"number"===f?(0,r.jsx)("input",{min:(null===e||void 0===e?void 0:e.minValue)||void 0,max:(null===e||void 0===e?void 0:e.maxValue)||void 0,type:"number",placeholder:c||"",value:s,onChange:function(e){a(e.target.value)}}):(0,r.jsx)("input",{type:f,placeholder:c||"",value:s,onChange:function(e){return a(e.target.value)}})})]}),o&&(0,r.jsx)("div",{className:l().adminFormButtonsHolder,children:o})]})}var K=t(88240),V=function(){var e=Object.keys(I.w5).map((function(e){return{id:I.w5[e].networkVersion,title:I.w5[e].chainName}}));return e.unshift({id:0,title:"Select Blockchain"}),e}();function U(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,a=e.getActiveChain,o=e.storageData,i=(0,x.useState)(null===o||void 0===o?void 0:o.chainId),c=i[0],d=i[1],u=(0,x.useState)(null===o||void 0===o?void 0:o.lotteryAddress),h=u[0],f=u[1],m=(0,x.useState)(null===o||void 0===o?void 0:o.tokenAddress),v=m[0],g=m[1],p=(0,x.useState)(!1),j=p[0],b=(p[1],(0,x.useState)(!1)),y=(b[0],b[1],(0,x.useState)(!1)),w=y[0],k=y[1],S=(0,x.useState)(!1),N=S[0],C=S[1],T=(0,x.useState)(null===o||void 0===o?void 0:o.tokenInfo),F=T[0],A=T[1],B=(0,x.useState)(!1),R=B[0],O=B[1],L=(0,x.useState)(void 0!==o.tokenInfo.address),E=L[0],_=L[1],P=(0,x.useState)(!1),W=P[0],U=P[1],Y=function(){t({title:"Save to storage",message:"Save changes to storage config?",onConfirm:function(){U(!0),n({onBegin:function(){s("Confirm transaction")},onReady:function(){U(!1),s("Changed saved","success")},onError:function(e){U(!1),s("Fail save changes. ".concat(e.message?e.message:""),"error")},newData:{chainId:c,tokenAddress:v,lotteryAddress:h,tokenInfo:F}})}})},G=function(){c?(_(!1),O(!1),A({}),s("Fetching token info"),Z(v,c).then((function(e){O(!1),A(e),_(!0),s("Token info fetched","success")})).catch((function(e){s("Fail fetch token info. ".concat(e.message?e.message:""),"error"),O(!1)}))):s("Fail fetch. Select work chain first","error")},z=function(){},J=function(){C(!1)},q=function(){C(!0)},X=(0,x.useState)(!1),$=(X[0],X[1],function(){if(!c)return s("Fail. Select work chain first","error");if(!E)return s("Fail. Fetch token info first","error");var e=a(),n=e.activeChainId,i=e.activeWeb3,r=(0,I.T_)(n);c&&E&&v&&t({title:"Deploying Lottery contract",message:"Deploy Lottery contract at ".concat(r.chainName," (").concat(n,")?"),onConfirm:function(){k(!0),s("Deploying lottery. Confrirm transaction"),M({activeWeb3:i,tokenAddress:v,feeOn:!(0,K.Z)("LOTTERY_FULL_VERSION",o),onTrx:function(e){s("Lottery contract deploy TX ".concat(e,"..."),"success")},onSuccess:function(e){try{s("Lottery contract deployed. Now save settings","success"),f(e),k(!1),C(!1)}catch(n){console.log(">>> onSuccess error",n)}},onError:function(e){s("Fail deploy Lottery contract. ".concat(e.message?e.message:""),"error"),k(!1),console.log(e)}}).catch((function(e){k(!1),s("Fail deploy Lottery contract. ".concat(e.message?e.message:""),"error")}))}})});return{render:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsx)("div",{className:l().adminSectionDescription,children:"Main settings. The blockchain in which the lottery will work is indicated here, the token for buying tickets is indicated and the lottery contract is deployed"}),H({label:"Work blockchain ID",type:"list",desc:"Your lottery will run on this blockchain",values:V,value:c,onChange:d}),N?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Deploy new Lottery contract options"}),(0,r.jsxs)("div",{className:l().subForm,children:[H({label:"Lottery token",type:"address",desc:"This token will be used to purchase tickets and as a reward in your lottery",value:v,onChange:g,placeholder:"Ender address of lottery ERC20 token",buttons:(0,r.jsx)(D,{chainId:c,className:l().adminSubButton,disabled:R,onClick:G,action:"Fetch token info",children:R?"Fetching":"Fetch token info"})}),E&&F&&F.address&&(0,r.jsxs)("div",{className:l().infoTable,children:[(0,r.jsx)("h3",{children:"Token info"}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Symbol:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.symbol})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.name})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Decimals:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.decimals})})]})]})]}),(0,r.jsxs)("div",{className:l().actionsRow,children:[(0,r.jsx)(D,{chainId:c,className:l().adminSubButton,disabled:w,onClick:$,action:"Deploy lottery contract",children:w?"Deploying":"Deploy Lottery contract"}),(0,r.jsx)("button",{className:"".concat(l().adminSubButton," ").concat(l().isCancel),disabled:w,onClick:J,children:"Cancel"})]})]})}):(0,r.jsxs)(r.Fragment,{children:[H({label:"Lottery contract",type:"address",value:h,desc:"Set up the lottery contract by clicking the 'Deploy new' button, if this is your first time setting it up",onChange:f,placeholder:"Enter address of lottery contract",buttons:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"".concat(l().adminSubButton),disabled:j||w,onClick:z,children:j?"Fetching info":"Fetch Lottery contract info"}),(0,r.jsx)("button",{className:"".concat(l().adminSubButton),disabled:j||w,onClick:q,children:"Deploy new Lottery contract"})]})}),E&&F&&F.address&&(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Token for which users buy tickets"}),(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Address:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.address})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Symbol:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.symbol})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Name:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.name})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Decimals:"}),(0,r.jsx)("span",{children:(0,r.jsx)("b",{children:F.decimals})})]})]})]})]}),(0,r.jsx)("div",{className:l().actionsRowMain,children:(0,r.jsx)(D,{chainId:"STORAGE",icon:"save",className:l().adminMainButton,disabled:W,onClick:Y,action:"Save changes",children:W?"Saving...":"Save to storage config"})})]})})}}}var Y=t(88765);function G(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,o=e.getActiveChain,i=e.storageData,c=(e.getStorageData,(0,x.useState)(0)),d=c[0],u=c[1],h=(0,x.useState)(0),f=h[0],g=h[1],p=(0,x.useState)(0),j=p[0],b=p[1],w=(0,x.useState)(!1),k=w[0],S=w[1],N=(0,x.useState)(i.ticketPrice),C=N[0],T=N[1],I=(0,x.useState)(!1),F=I[0],A=I[1],B=(0,x.useState)(!1),R=(B[0],B[1]),O=(0,x.useState)(i.buyTokenLink),L=O[0],E=O[1];(0,x.useEffect)((function(){i.lotteryAddress&&i.chainId&&(0,Y.Z)({isCall:!0,chainId:i.chainId,contractAddress:i.lotteryAddress,method:"numbersCount",args:[]}).then((function(e){Q(e)}))}),[i]);var Z=(0,x.useState)(i.matchRules||{match_1:39.2,match_2:58.8,match_3:6.125,match_4:12.25,match_5:24.5,match_6:49}),_=Z[0],P=Z[1],W=(0,x.useState)([1,2,3,4,5,6]),M=W[0],H=W[1],K=(0,x.useState)(!1),V=K[0],U=K[1],G=(0,x.useState)(!1),z=G[0],J=G[1],q=(0,x.useState)(i.burn),X=q[0],$=q[1],Q=function(e){e<2&&(e=2),e>6&&(e=6),b(e),S("".concat(i.balls)!=="".concat(e)),H((function(n){return[1,2,3,4,5,6].filter((function(n){return n<=parseInt(e)}))}))};(0,x.useEffect)((function(){!function(){for(var e=0,n=1;n<=6;n++)n<=j&&(e+=_["match_".concat(n)]);u(e),g(100-e)}()}),[j,_]);var ee=function(){t({title:"Save changes to Lottery",message:"Save new count of balls?",onConfirm:function(){U(!0);var e=o().activeWeb3;s("Confirm transaction"),(0,Y.Z)({activeWeb3:e,contractAddress:i.lotteryAddress,method:"setNumbersCount",args:[j]}).then((function(e){U(!1),S(!1),s("Changes saved","success")})).catch((function(e){U(!1),s("Fail save balls count. ".concat(e.message?e.message:""),"error")}))}})},ne=function(){t({title:"Save match rules",message:"Save winning balls match rules, burn amount and ticket price to storage config?",onConfirm:function(){J(!0),s("Saving winning rules..."),n({onBegin:function(){s("Confirm transaction")},onReady:function(){J(!1),s("Changed saved","success")},onError:function(e){J(!1),s("Fail save changes. ".concat(e.message?e.message:""),"error")},newData:{matchRules:_,burn:X,balls:j,ticketPrice:C,buyTokenLink:L}})}})};return{render:function(){var e;return i.lotteryAddress?(0,r.jsx)("div",{className:l().adminForm,children:(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery rules"}),(0,r.jsx)("div",{className:l().subForm,children:(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The number of balls that will be drawn in your lottery. Number two to six"})]}),"Balls count:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"2",max:"6",step:"1",value:j,onChange:function(e){Q(e.target.value)}}),(0,r.jsx)(D,{chainId:i.chainId,onClick:ee,disabled:V,icon:"save",action:"Save balls count",className:l().adminButton,children:V?"Saving the number of balls in the lottery contract":"Save the number of balls in the lottery contract"})]})})]})}),(0,r.jsx)("h3",{children:"Distribution of prizes %"}),(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsx)("h4",{children:"Distribute the winning percentage based on the number of matched balls"}),(0,r.jsx)("div",{className:l().adminFieldDesc,children:'You can also use the "Equalize the remainder" button to distribute the remaining percentage in the desired field'}),M.map((function(e){return(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:["The percentage of winnings from the bank when ",e," number matches"]})]}),"Match ",e," ball:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"0",max:"100",step:"0.01",value:_["match_".concat(e)],onChange:function(n){var t=0;try{t=parseFloat(n.target.value)}catch(s){t=0}t<0&&(t=0),t>100&&(t=100),P((function(n){return(0,v.Z)((0,a.Z)({},n),(0,m.Z)({},"match_".concat(e),t))}))}}),(0,r.jsx)("strong",{children:"%"}),(0,r.jsxs)("button",{className:l().adminButton,onClick:function(){var n;n=e,P((function(e){return(0,v.Z)((0,a.Z)({},e),(0,m.Z)({},"match_".concat(n),e["match_".concat(n)]+f))}))},children:[(0,r.jsx)(y,{icon:"arrow-left"}),"Equalize the remainder"]})]})})]},e)})),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The sum of all winning combinations is on top. This number must be equal to 100%"})]}),"Sum:"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("b",{children:d}),(0,r.jsx)("strong",{children:"%"})]})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"The amount of undistributed winnings from the field above. This number must be 0%"})]}),"Undistributed:"]}),(0,r.jsx)("div",{children:0!==f?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("b",{className:l().hasError,children:[f," %"]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("b",{children:f}),(0,r.jsx)("strong",{children:"%"})]})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"As an administrator, you have the option to set a service fee for each round of the lottery."}),(0,r.jsx)("span",{children:'The service fee is transferred to your wallet address, and a portion of this fee, equal to 1/5 of the service fee, is deducted as the "onout.org" fee.'}),(0,r.jsx)("span",{children:'The "onout.org" fee can be removed by purchasing the premium version of the lottery service.'})]})]}),"Service fee (From 2 to 30):"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"2",max:"30",value:X,onChange:function(e){$(e.target.value)}}),(0,r.jsx)("strong",{children:"%"})]})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Ticket price:"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",step:"0.1",min:"0",value:C,onChange:function(e){!function(n){A(!1);try{(n=parseFloat(n))<0&&A(!0),n>50&&A(!0)}catch(e){A(!0)}T(n),R(i.ticketPrice!==n)}(e.target.value)}}),(0,r.jsx)("strong",{children:null===i||void 0===i||null===(e=i.tokenInfo)||void 0===e?void 0:e.symbol})]}),F&&(0,r.jsx)("div",{className:l().hasError,children:(0,r.jsx)("strong",{children:"Price must be between 0.00000000001 and 50"})})]})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:(0,r.jsx)("span",{children:"Link to the service where users can buy your token to pay for tickets"})})]}),"Buy Token link:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:L,onChange:function(e){E(e.target.value)}})})})]}),(0,r.jsxs)("div",{className:l().actionsRow,children:[k&&(0,r.jsx)("strong",{className:l().hasError,children:"Save balls count first!"}),(0,r.jsx)(D,{chainId:"STORAGE",onClick:ne,disabled:z||k,icon:"save",action:"Save changes",className:l().adminSubButton,children:z?"Saving...":"Save match rules, burn amount and ticket price"})]})]})]})}):(0,r.jsxs)("div",{className:l().errorBlock,children:[(0,r.jsx)("span",{children:"Section not accessible"}),(0,r.jsx)("span",{children:"Deploy and save the lottery contract first"})]})}}}var z=function(e){return new Promise(function(){var n=(0,s.Z)(i().mark((function n(t,s){var a,o,r,c,l,d,u,h,f,m;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=e.chainId,o=e.contractAddress,!(r=(0,I.T_)(a))){n.next=27;break}return n.prev=3,c=new(E())(r.rpcUrls[0]),l=new c.eth.Contract(_.Mt,o),n.next=8,l.methods.owner().call();case 8:return d=n.sent,n.next=11,l.methods.operatorAddress().call();case 11:return u=n.sent,n.next=14,l.methods.treasuryAddress().call();case 14:return h=n.sent,n.next=17,l.methods.viewCurrentLotteryId().call();case 17:return f=n.sent,n.next=20,l.methods.viewLottery(f).call();case 20:m=n.sent,t({chainId:a,contractAddress:o,owner:d,operator:u,treasury:h,currentLotteryInfo:m,currentLotteryNumber:f}),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(3),s(n.t0);case 27:case"end":return n.stop()}}),n,null,[[3,24]])})));return function(e,t){return n.apply(this,arguments)}}())},J=function(e,n){var t=Number(n-e),s=Math.floor(t/3600),a=Math.floor(t%3600/60),o=Math.floor(t%3600%60);return(s>0?s+(1==s?" hour, ":" hours, "):"")+(a>0?a+(1==a?" minute, ":" minutes, "):"")+(o>0?o+(1==o?" second":" seconds"):"")},q=function(e){var n=e.ownerAddress,t=e.tokenAddress,s=e.chainId,a=e.approveFor;return new Promise((function(e,o){var i=(0,I.T_)(s);if(i)try{new(new(E())(i.rpcUrls[0]).eth.Contract)(O(),t).methods.allowance(n,a).call().then((function(n){e(n)})).catch((function(e){o(e)}))}catch(r){o(r)}else o("NOT_SUPPORTED_CHAIN")}))},X=t(10797),$=t(53419),Q=function(e){return new Promise((function(n,t){var a=e.activeWeb3,o=(e.chainId,e.tokenAddress),r=e.approveFor,c=e.weiAmount,l=e.onTrx||function(){},d=e.onSuccess||function(){},u=e.onError||function(){},h=e.onFinally||function(){};a.eth.getAccounts().then(function(){var e=(0,s.Z)(i().mark((function e(s){var f,m,v,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s.length>0)){e.next=10;break}return m=s[0],v=new a.eth.Contract(O(),o),e.next=6,(0,$.A)(m,v,"approve",[r,c]);case 6:x=e.sent,(f=v.methods).approve.apply(f,(0,X.Z)([r,c])).send(x).on("transactionHash",(function(e){console.log("transaction hash:",e),l(e)})).on("error",(function(e){console.log("transaction error:",e),u(e),t(e)})).on("receipt",(function(e){console.log("transaction receipt:",e),d(e)})).then((function(e){n(e),h(e)})),e.next=11;break;case 10:t("NO_ACTIVE_ACCOUNT");case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){console.log(">>> approveToken",e),t(e)}))}))},ee=t(35553),ne=t(72023),te=t.n(ne),se=function(){for(var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=n.length,s=0;s<128;s++)e+=n.charAt(Math.floor(Math.random()*t));return e};function ae(e){e.setDoReloadStorage,e.saveStorageConfig;var n=e.openConfirmWindow,t=e.addNotify,s=e.getActiveChain,a=e.storageData,o=(e.getStorageData,(0,x.useState)(!1)),i=o[0],c=o[1],d=(0,x.useState)(!1),u=d[0],h=d[1],f=(0,x.useState)(!1),m=f[0],v=f[1],g=(0,x.useState)(!1),j=g[0],b=g[1],w=(0,x.useState)(!1),k=w[0],S=w[1],N=(0,x.useState)(""),C=N[0],T=N[1],I=(0,x.useState)(0),F=I[0],A=I[1],B=(0,x.useState)(!1),R=B[0],O=B[1],L=(0,x.useState)(!1),E=L[0],Z=L[1],_=(0,x.useState)(!1),P=_[0],M=_[1],H=(0,x.useState)(!1),K=H[0],V=H[1];(0,x.useEffect)((function(){if(i&&u){var e=new Date("".concat(i," ").concat(u)).getTime()/1e3,n=J((0,p.K)(),e);v(n)}}),[i,u]);var U=function(){a.chainId&&a.lotteryAddress&&(t("Fetching lottery status"),z({chainId:a.chainId,contractAddress:a.lotteryAddress}).then((function(e){t("Lottery status fetched","success"),b(e),S(e.currentLotteryInfo)})))};(0,x.useEffect)((function(){V(!1);var e=new(W())(k.amountCollectedInCake).div(new(W())(10).pow(a.tokenInfo.decimals)).toNumber();A(e),O(new Date(1e3*parseInt(k.startTime,10)).toString()),Z(new Date(1e3*parseInt(k.endTime,10)).toString()),M(J((0,p.K)(),parseInt(k.endTime,10)+60)),"1"===k.status&&parseInt(k.endTime,10)-(0,p.K)()<0?(T("lottery_round"),V(!0)):"1"!==j.currentLotteryNumber&&"1"===k.status?T("lottery_round"):"2"===k.status?T("lottery_draw"):"3"===k.status&&T("lottery_start")}),[k]),(0,x.useEffect)((function(){U()}),[a]);var G=(0,x.useState)(!1),X=G[0],$=G[1],ne=function(){var e;return void 0===(null===a||void 0===a||null===(e=a.tokenInfo)||void 0===e?void 0:e.decimals)?t("Fail. No information about token. Fetch them first and return","error"):(null===a||void 0===a?void 0:a.ticketPrice)?(null===a||void 0===a?void 0:a.burn)?i&&u?void n({title:"New round",message:"Start new lottery round?",onConfirm:function(){var e=new(W())(a.ticketPrice).multipliedBy(Math.pow(10,a.tokenInfo.decimals)).toFixed(),n=parseInt(100*a.burn,10),o=[1,2,3,4,5,6].map((function(e){return e<=a.balls?parseInt(100*parseFloat(a.matchRules["match_".concat(e)]),10):0})),r=new Date("".concat(i," ").concat(u)).getTime()/1e3;t("Starting new lottery round..."),$(!0);var c=s().activeWeb3;(0,Y.Z)({activeWeb3:c,contractAddress:a.lotteryAddress,method:"startLottery",args:[r,e,2e3,o,n]}).then((function(e){$(!1),U(),t("New lottery round started","success")})).catch((function(e){$(!1),t("Fail start new lottery round. ".concat(e.message?e.message:""),"error")}))}}):t("Fail. Enter date of lottery round end","error"):t("Fail. Burn amount not setted","error"):t("Fail. Ticket price not setted.","error")},ae=(0,x.useState)(0),oe=ae[0],ie=ae[1],re=(0,x.useState)(!1),ce=(re[0],re[1]),le=function(){n({title:"Inject lotery bank amount",message:"Add ".concat(oe," ").concat(null===a||void 0===a?void 0:a.tokenInfo.symbol," to the pot of the lottery round?"),onConfirm:function(){ce(!0);var e,n,o=(e=oe,ee.vz("".concat(e),n)),i=s();t("Inject bank. Check allovance"),q({ownerAddress:i.activeAccount,tokenAddress:null===a||void 0===a?void 0:a.tokenAddress,chainId:null===a||void 0===a?void 0:a.chainId,approveFor:null===a||void 0===a?void 0:a.lotteryAddress}).then((function(e){var n=function(){t("Injecting round bank. Confirm transaction"),(0,Y.Z)({activeWeb3:i.activeWeb3,contractAddress:a.lotteryAddress,method:"injectFunds",args:[j.currentLotteryNumber,o]}).then((function(e){ce(!1),U(),t("The bank or round was replenished","success")})).catch((function(e){ce(!1),t("Fail inject funds. ".concat(e.message?e.message:""),"error")}))};new(W())("".concat(o)).isGreaterThan(e)?(t("Inject bank. Need approve"),Q({activeWeb3:i.activeWeb3,chainId:null===a||void 0===a?void 0:a.chainId,tokenAddress:null===a||void 0===a?void 0:a.tokenAddress,approveFor:null===a||void 0===a?void 0:a.lotteryAddress,weiAmount:o}).then((function(e){n()})).catch((function(e){ce(!1),t("Fail approve for inject round bank. ".concat(e.message?e.message:""),"error")}))):n()})).catch((function(e){ce(!1),t("Fail inject round bank. ".concat(e.message?e.message:""),"error")}))}})},de=(0,x.useState)(!1),ue=de[0],he=de[1],fe=function(){var e=s();he(!0),t("Closing lottery round. Confirm transaction"),(0,Y.Z)({activeWeb3:e.activeWeb3,contractAddress:a.lotteryAddress,method:"closeLottery",args:[j.currentLotteryNumber]}).then((function(e){he(!1),U(),t("Lottery round was closed","success")})).catch((function(e){he(!1),t("Fail close lottery round. ".concat(e.message?e.message:""),"error")}))},me=(0,x.useState)(se()),ve=me[0],xe=me[1],ge=function(){xe(se())},pe=(0,x.useState)(!1),je=pe[0],be=pe[1],ye=function(){var e=se(),n=te()("".concat(e).concat(ve));be(!0),t("Drawing winning numbers. Confirm transaction");var o=s();(0,Y.Z)({activeWeb3:o.activeWeb3,contractAddress:a.lotteryAddress,method:"drawFinalNumberAndMakeLotteryClaimable",args:[j.currentLotteryNumber,"0x".concat(n),!0]}).then((function(e){be(!1),U(),t("Winning numbers drawed!","success")})).catch((function(e){be(!1),t("Fail draw winning numbers. ".concat(e.message?e.message:""),"error")}))};return{render:function(){var e,n;return a.lotteryAddress?(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsx)("div",{className:l().adminSectionDescription,children:"This section is where the lottery rounds are managed. Start of a new round, end of the round and calculation of winning balls"}),"lottery_start"===C&&(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Start new lottery round"}),(0,r.jsx)("div",{className:l().adminSubFormDesc,children:"There are currently no rounds running. Start a new lottery round"}),(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"The date and time when the sale of tickets will be stopped and the lottery will enter the winning balls calculation mode."}),(0,r.jsx)("span",{children:"The minimum round time is 5 minutes."}),(0,r.jsx)("span",{children:"The maximum round time is 31 days."})]})]}),"Round end in:"]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"date",value:i,onChange:function(e){c(e.target.value)}}),(0,r.jsx)("input",{type:"time",value:u,onChange:function(e){h(e.target.value)}}),(0,r.jsx)("strong",{children:"(min 5 minutes, max 31 days)"})]}),m&&(0,r.jsx)("div",{children:(0,r.jsxs)("strong",{children:["Round length is ",m]})})]})]}),(0,r.jsx)("div",{className:l().actionsRow,children:(0,r.jsx)(D,{className:l().adminSubButton,onClick:ne,disabled:X,chainId:null===a||void 0===a?void 0:a.chainId,action:"Start new round",children:X?"Starting new lottery round...":"Start new lottery round"})})]})]}),"lottery_round"===C&&(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery round is running now"}),(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Round started:"}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:R})})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{children:"Round ends:"}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:E})})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"How much time is left until the end of the current round."}),(0,r.jsx)("span",{children:"After this time, the sale of tickets will be terminated and the lottery will switch to the mode of calculating winning balls."})]})]}),"Time left:"]}),(0,r.jsx)("div",{children:K?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"The time for the round has passed."}),(0,r.jsx)("span",{children:"You need to close the lottery and move on to generating winning balls"})]})]}),(0,r.jsx)("strong",{children:"Time is over. Close Lottery round."})]}):(0,r.jsxs)("div",{children:[(0,r.jsx)("strong",{children:P}),(0,r.jsxs)("button",{className:l().adminButton,onClick:U,children:[(0,r.jsx)(y,{icon:"refresh"}),"Fetch status"]})]})})]}),K&&(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:["The time for the round has passed. You need to close the lottery and move on to generating winning balls",(0,r.jsx)("span",{children:'Click "Close round" to proceed to the calculation of winning balls'})]})]}),"Close Lottery round:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)(D,{chainId:null===a||void 0===a?void 0:a.chainId,action:"Close round",onClick:fe,disabled:ue,className:l().adminButton,children:ue?"Closing...":"Close Lottery round"})})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"How many tokens are raffled off in the current round."}),(0,r.jsx)("span",{children:"If you wish, you can increase the amount of tokens in the bank."}),(0,r.jsx)("span",{children:'To do this, use the "Inject lotery bank funds" section below.'})]})]}),"Round bank:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsxs)("strong",{children:[F," ",null===a||void 0===a||null===(e=a.tokenInfo)||void 0===e?void 0:e.symbol]})})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"In this section, you can add tokens to the bank of the current lottery round."}),(0,r.jsx)("span",{children:"The added tokens will be distributed among the winning tickets."}),(0,r.jsx)("span",{children:"Unallocated tokens will be transferred to the general lottery bank and raffled off in the next rounds"})]})]}),"Inject lotery bank funds:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"number",min:"0",step:"0.01",value:oe,onChange:function(e){ie(e.target.value)}}),(0,r.jsx)("strong",{children:null===a||void 0===a||null===(n=a.tokenInfo)||void 0===n?void 0:n.symbol})]})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsx)("label",{}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)(D,{className:l().adminButton,onClick:le,chainId:null===a||void 0===a?void 0:a.chainId,action:"Add tokens to lottery bank",icon:"add",children:"Approve and add to round bank"})})})]})]})]}),"lottery_draw"===C&&(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"The lottery round is over. You need to calculate the winning combination"}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:"A unique randomly generated string that will be used as a salt during the calculation of winning balls."}),(0,r.jsx)("span",{children:"The uniqueness of this string guarantees protection against fraud by users."})]})]}),"Uniq salt:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("input",{type:"text",value:ve,readOnly:!0}),(0,r.jsx)("button",{className:l().adminButton,onClick:ge,children:"Generate"})]})})]}),(0,r.jsx)("div",{className:l().actionsRow,children:(0,r.jsx)(D,{className:l().adminButton,onClick:ye,disabled:je,chainId:null===a||void 0===a?void 0:a.chainId,action:"Calculate winning number",children:"Calculate winning numbers"})})]})]}):(0,r.jsxs)("div",{className:l().errorBlock,children:[(0,r.jsx)("span",{children:"Section not accessible"}),(0,r.jsx)("span",{children:"Deploy and save the lottery contract first"})]})}}}var oe=t(37826);function ie(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,s=e.addNotify,o=(e.getActiveChain,e.storageData),i=e.storageTexts,c=(0,x.useState)(o.texts),d=c[0],u=c[1],h=(0,x.useState)(!1),f=h[0],g=h[1],j=localStorage.getItem("-nft-stake-preview-text-mode"),b=localStorage.getItem("-nft-stake-preview-texts");try{b=JSON.parse(b),b=(0,a.Z)({},i,b)}catch(L){b=i}var k=(0,x.useState)(null!==j),S=k[0],N=k[1],C=function(){t({title:"Switch to preview mode",message:"Switch to preview mode? You can look changes before save",onConfirm:function(){s("Preview mode on. Go to site for check it","success"),localStorage.setItem("-nft-stake-preview-text-mode",!0),localStorage.setItem("-nft-stake-preview-texts",JSON.stringify(d)),N(!0)}})},T=function(){s("Preview mode turn off","success"),localStorage.removeItem("-nft-stake-preview-text-mode"),localStorage.removeItem("-nft-stake-preview-texts"),N(!1)};(0,x.useEffect)((function(){S&&(localStorage.setItem("-nft-stake-preview-texts",JSON.stringify(d)),localStorage.setItem("-nft-stake-preview-texts-utx",(0,p.K)()))}),[d]);var I=function(){t({title:"Save texts",message:"Save changes to storage config?",onConfirm:function(){g(!0),n({onBegin:function(){T(),s("Confirm transaction for save changed texts")},onReady:function(){s("Texts successfull saved","success"),g(!1)},onError:function(e){s("Fail save texts","error"),g(!1)},newData:{texts:d}})}})},F=function(e,n){u((function(t){return(0,v.Z)((0,a.Z)({},t),(0,m.Z)({},"".concat(e),n))}))},A=function(e){var n=e.code,t=e.desc,s=(e.value,e.defValue),a=e.multiline,o=e.multilineView,i=e.markdown;return(0,r.jsxs)("div",{className:l().adminStorageTextArea,children:[(0,r.jsxs)("label",{children:[t," (",n,") ",i&&(0,r.jsx)("b",{children:"(MarkDown)"})," ",a&&(0,r.jsx)("b",{children:"(Multiline)"})]}),a||o?(0,r.jsx)("textarea",{value:void 0!==d[n]?d[n]:s,onChange:function(e){F(n,e.target.value)}}):(0,r.jsx)("input",{type:"text",value:void 0!==d[n]?d[n]:s,onChange:function(e){F(n,e.target.value)}})]})},B=(0,x.useState)({}),R=B[0],O=B[1];return{render:function(){return(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsx)("div",{className:l().adminSectionDescription,children:"In this section, labels are edited."}),Object.keys(oe.D).map((function(e){return w({title:oe.D[e].title,isOpened:R[e],onToggle:function(){!function(e){O((function(n){return(0,v.Z)((0,a.Z)({},n),(0,m.Z)({},"".concat(e),void 0===R[e]||!R[e]))}))}(e)},key:e,content:(0,r.jsx)("div",{className:l().adminFormTextGroup,children:oe.D[e].items.map((function(e,n){var t=e.code,s=e.desc,a=e.value,o=e.multiline,i=e.markdown,c=e.multilineView;return(0,r.jsx)("div",{children:A({code:t,desc:s,defValue:a,multiline:o,multilineView:c,markdown:i})},n)}))})})})),(0,r.jsx)("div",{className:l().adminSectionDescription,children:"You can turn on the preview mode and look at the changes before saving them to the storage contract"}),(0,r.jsxs)("div",{className:l().actionsRowMain,children:[S?(0,r.jsxs)("button",{onClick:T,className:l().adminSubButton,children:[(0,r.jsx)(y,{icon:"eye-slash"}),"Turn off preview mode"]}):(0,r.jsxs)("button",{onClick:C,className:l().adminSubButton,children:[(0,r.jsx)(y,{icon:"eye"}),"Turn on preview mode"]}),(0,r.jsx)(D,{chainId:"STORAGE",disabled:f,onClick:I,action:"Save changes",icon:"save",className:l().adminSubButton,children:f?"Saving...":"Save changes"})]})]})}}}var re=function(e,n,t){return new Promise((function(s,a){var o=(0,I.T_)(t);if(o)try{var i=new(new(E())(o.rpcUrls[0]).eth.Contract)(O(),n);i.methods.decimals().call().then((function(o){i.methods.balanceOf(e).call().then((function(a){var i=function(e,n){return ee.bM(e,n)}(a,o);s({wallet:e,tokenAddress:n,chainId:t,decimals:o,wei:a,normalized:i})})).catch((function(e){a(e)}))})).catch((function(e){a(e)}))}catch(r){a(r)}else a("NOT_SUPPORTED_CHAIN")}))};function ce(e){e.setDoReloadStorage,e.saveStorageConfig;var n=e.openConfirmWindow,t=e.addNotify,s=e.getActiveChain,a=e.storageData,o=(e.getStorageData,(0,x.useState)(!1)),i=o[0],c=o[1],d=(0,x.useState)(0),u=d[0],h=d[1],f=(0,x.useState)(0),m=f[0],v=f[1],g=(0,x.useState)(!1),j=g[0],b=g[1],y=(0,x.useState)(0),w=y[0],k=y[1],S=(0,x.useState)(!0),N=S[0],C=S[1],T=function(){n({title:"Withdraw Lottery bank",message:"Do you really want to withdraw the entire bank from the lottery contract?",onConfirm:function(){c(!0);var e=s().activeWeb3;(0,Y.Z)({activeWeb3:e,contractAddress:a.lotteryAddress,method:"withdrawBank",args:[j.wei]}).then((function(e){c(!1),C(!0),t("Lottery bank withdrawed","success")})).catch((function(e){c(!1),t("Fail withdraw lottery bank. ".concat(e.message?e.message:""),"error")}))}})};return(0,x.useEffect)((function(){a.chainId&&a.lotteryAddress&&a.tokenAddress&&N&&(t("Fetching lottery status"),z({chainId:a.chainId,contractAddress:a.lotteryAddress}).then((function(e){var n=e.currentLotteryInfo;console.log(">>> lotteryStatus",e),h(n.endTime),v(n.status),k(Number(n.endTime)+2678400-(0,p.K)()),re(a.lotteryAddress,a.tokenAddress,a.chainId).then((function(e){b(e),C(!1)}))})))}),[a]),{render:function(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsx)("div",{className:l().adminSectionDescription,children:"As an administrator, you have the option to withdraw unclaimed funds from the bank after two months have passed since the last round of the lottery. However, please be aware that a portion of the withdrawal, equal to 1/5 of the total amount, will be deducted as the OnOut fee. If you wish to avoid this fee, you can purchase the premium version of the lottery service."}),(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Lottery bank info"}),a.tokenInfo&&a.chainId&&a.lotteryAddress&&a.tokenInfo.symbol&&j?(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"Date when the last round was closed"})]}),"Last round ends in:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("strong",{children:new Date(1e3*Number(u)).toString()})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"How much time has passed since the last round closed"})]}),"Time left:"]}),(0,r.jsx)("div",{children:w>0?(0,r.jsx)("strong",{children:J((0,p.K)(),Number(u)+2678400)}):(0,r.jsx)("strong",{children:"Freeze time is up. You can take the bank"})})]}),(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:"How much is in the lottery bank now"})]}),"Lottery bank:"]}),(0,r.jsx)("div",{children:(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{children:j.normalized}),(0,r.jsx)("strong",{children:a.tokenInfo.symbol})]})})]}),(0,r.jsx)("div",{className:l().actionsRow,children:(0,r.jsx)(D,{chainId:a.chainId,onClick:T,disabled:i||w>0||"3"!=m,icon:"money-bill-transfer",action:"Withdraw bank",className:l().adminButton,children:i?"Withdrawing lottery bank":"Withdraw lottery bank"})})]}):(0,r.jsx)("div",{children:"Fetching info..."})]})]})})}}}var le,de,ue=function(){var e=(0,s.Z)(i().mark((function e(n){var t,s,a,o,r,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.symbol,s=n.vsCurrency,e.prev=1,e.next=5,fetch("".concat("https://noxon.wpmix.net/cursAll.php","?fiat=").concat(s,"&tokens=").concat(t)).then((function(e){return e.json()}));case 5:return r=e.sent,c=null===r||void 0===r||null===(a=r.data)||void 0===a||null===(o=a.find)||void 0===o?void 0:o.call(a,(function(e){return(null===e||void 0===e?void 0:e.symbol)===t})),e.abrupt("return",c.quote[s].price);case 10:return e.prev=10,e.t0=e.catch(1),console.group("%c getPrice","color: red;"),console.error(e.t0),console.groupEnd(),e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(n){return e.apply(this,arguments)}}(),he=function(){var e=(0,s.Z)(i().mark((function e(n){var t,s,a,o,r,c,l,d;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.provider,s=n.from,a=n.to,o=n.amount,r=n.onHash,c=void 0===r?function(){}:r,l=n.data,d={from:s,to:a,value:ee.vz(String(o),"ether").toHexString(),data:l},e.prev=2,e.next=5,t.eth.sendTransaction(d).on("transactionHash",(function(e){return c(e)}));case 5:return e.abrupt("return",e.sent);case 8:throw e.prev=8,e.t0=e.catch(2),console.group("%c send","color: red;"),console.error(e.t0),console.groupEnd(),e.t0;case 14:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(n){return e.apply(this,arguments)}}(),fe={LOTTERY_OFF_COPYRIGTH:{title:"LotteryFactory - Disable copyright",desc:"LotteryFactory - Disables copyright of OnOut",price:.1,chainId:56,product:"LotteryFactory",include_packs:[]},LOTTERY_FULL_VERSION:{title:"LotteryFactory - Full version",desc:"LotteryFactory - Full version. Disabled copyright of OnOut. Onout commission disabled",price:1500,isUSDT:!0,chainId:[1,56],product:"LotteryFactory",include_packs:["LOTTERY_OFF_COPYRIGTH"]}},me=t(34360),ve=t(8433);!function(e){e[e.danger=1]="danger",e[e.success=2]="success",e[e.warning=3]="warning",e[e.attention=4]="attention",e[e.unimportant=5]="unimportant",e[e.voteIdea=6]="voteIdea",e[e.bonusFuel=7]="bonusFuel"}(le||(le={}));var xe=(de={},(0,m.Z)(de,le.danger,"\u2b55"),(0,m.Z)(de,le.success,"\ud83d\udfe2"),(0,m.Z)(de,le.warning,"\ud83d\udd25"),(0,m.Z)(de,le.attention,"\ud83d\udca5"),(0,m.Z)(de,le.unimportant,"\ud83d\udca4"),(0,m.Z)(de,le.voteIdea,"\ud83d\udc24"),(0,m.Z)(de,le.bonusFuel,"\u26fd"),de),ge=function(e){var n=e.msg,t=e.status,s=window.location.hostname||document.location.host;if("localhost"!==s){var a=["localhost"===s?"".concat(xe[le.unimportant]," "):t&&xe[t]?"".concat(xe[t]," "):"","[".concat(s,"] "),n].join("");try{(0,ve.Z)({url:"".concat("https://noxon.wpmix.net/counter.php","?msg=").concat(encodeURI(a),"&toonoutdev=1&version=2"),method:"post"}).catch((function(e){return console.error(e)}))}catch(o){console.error(o)}}};function pe(e){e.setDoReloadStorage;var n=e.saveStorageConfig,t=e.openConfirmWindow,a=e.addNotify,o=e.getActiveChain,c=e.storageData,d=(e.getStorageData,o().activeChainId),u=(0,I.T_)(d),h=(0,x.useState)(""),f=h[0],m=h[1],v=(0,x.useState)(!1),g=v[0],p=v[1],j=(0,x.useState)(0),b=j[0],w=j[1],k=(0,x.useState)(0),S=k[0],N=k[1],T=(0,x.useState)(!1),F=T[0],B=T[1],R=(0,x.useState)(""),O=R[0],L=R[1],E=(0,x.useState)(!1),Z=E[0],_=E[1],P=(0,x.useState)(!1),W=P[0],M=P[1],H=function(){var e=(0,s.Z)(i().mark((function e(){var n,t,s,r,c;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o(),t=n.activeWeb3,s=n.activeAccount,a("Begin purchase... Confirm transaction"),_(!0),e.prev=3,ge({msg:"Begin buy activate key ".concat(O," from ").concat(s),status:le.attention}),e.next=7,he({provider:t,from:s,to:"0x873351e707257C28eC6fAB1ADbc850480f6e0633",amount:S,onHash:function(e){a("Pay TX ".concat(e),"success")}});case 7:(null===(r=e.sent)||void 0===r?void 0:r.status)&&(ge({msg:"Activation key bought ".concat(O," from ").concat(s),status:le.success}),a("Successfull purchesed","success"),_(!1),p(!1),c=(0,me.Z)(O,s),m(c),G(!0),a("Your key ".concat(c,". Save it"),"success")),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(3),a("Fail purchase. ".concat(e.t0.message?e.t0.message:""),"error"),_(!1),M(e.t0.message);case 16:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=(0,s.Z)(i().mark((function e(n){var t,s,a;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(n),t=fe[n],s=u.nativeCurrency.symbol,e.next=5,ue({symbol:s,vsCurrency:"USD"});case 5:a=e.sent,t.isUSDT?(w(t.price),N(t.price/a),B(!1)):(N(t.price),w(t.price*a),B(!0)),ge({msg:"Open buy key ".concat(n),status:le.attention}),p(!0);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),U=(0,x.useState)(!1),Y=U[0],G=U[1],z=(0,x.useState)(!1),J=z[0],q=z[1],$=function(){Q(f)?(ge({msg:"Activate key ".concat(f),status:le.success}),t({title:"Activating license key",message:"Activate license key?",onConfirm:function(){q(!0),n({onBegin:function(){a("Confirm transaction")},onReady:function(){q(!1),a("Key activated","success"),G(!1),m("")},onError:function(e){q(!1),a("Fail activate key. ".concat(e.message?e.message:""),"error")},newData:{licenseKeys:(0,X.Z)(null===c||void 0===c?void 0:c.licenseKeys).concat([f])}})}})):a("You entered an invalid activation key","error")},Q=function(e){var n=o().activeAccount,t=Object.keys(fe).filter((function(e){return(0,me.Z)(e,n)==f}));return t.length>0};return{render:function(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:l().adminForm,children:[(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Activating an existing purchase key"}),(0,r.jsxs)("div",{className:l().subForm,children:[(0,r.jsxs)("div",{className:l().infoRow,children:[(0,r.jsxs)("label",{children:[(0,r.jsxs)("div",{className:l().helpTooltip,children:[(0,r.jsx)("span",{children:"?"}),(0,r.jsx)("div",{children:'If you already have an activation key. Specify it in this field and click "Activate"'})]}),"Purchase key:"]}),(0,r.jsx)("div",{children:(0,r.jsx)("div",{children:(0,r.jsx)("input",{type:"text",value:f,onChange:function(e){m(e.target.value)}})})})]}),(0,r.jsx)("div",{className:l().actionsRow,children:(0,r.jsx)(D,{chainId:"STORAGE",onClick:$,disabled:J,icon:"receipt",action:"Active key",className:l().adminButton,children:J?"Key activation...":"Activate key"})})]})]}),(0,r.jsxs)("div",{className:l().subFormInfo,children:[(0,r.jsx)("h3",{children:"Purchasing a product activation key"}),(0,r.jsxs)("div",{className:"jsx-a34ffd9bc7fe9e6a PurchaseKeys",children:[(0,r.jsx)(C(),{id:"a34ffd9bc7fe9e6a",children:".PurchaseKeys.jsx-a34ffd9bc7fe9e6a{}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a{margin:10px;padding:4px;border:1px solid#fff;-webkit-box-shadow:0 0 2px 2px#4f5760;-moz-box-shadow:0 0 2px 2px#4f5760;box-shadow:0 0 2px 2px#4f5760;background:#403f3f}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .title.jsx-a34ffd9bc7fe9e6a{font-size:12pt;font-weight:bold;border-bottom:1px solid#fff;padding:4px;text-shadow:1px 1px black,-1px 1px black,1px -1px black,-1px -1px black}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .desc.jsx-a34ffd9bc7fe9e6a{padding:15px;font-size:10pt}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .buyHolder.jsx-a34ffd9bc7fe9e6a{padding:4px;border-top:1px solid#fff;text-align:right}.PurchaseKeys.jsx-a34ffd9bc7fe9e6a .card.jsx-a34ffd9bc7fe9e6a .buyHolder.jsx-a34ffd9bc7fe9e6a STRONG.jsx-a34ffd9bc7fe9e6a{color:#64d31f}"}),Object.keys(fe).map((function(e){var n=(0,K.Z)(e,c);return(0,r.jsxs)("div",{className:"jsx-a34ffd9bc7fe9e6a card",children:[(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a title",children:fe[e].title}),(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a desc",children:fe[e].desc}),(0,r.jsx)("div",{className:"jsx-a34ffd9bc7fe9e6a buyHolder",children:n?(0,r.jsxs)("strong",{className:"jsx-a34ffd9bc7fe9e6a",children:[(0,r.jsx)(y,{icon:"circle-check"})," ","You already got it"]}):(0,r.jsx)(D,{chainId:fe[e].chainId,onClick:function(){V(e)},disabled:!1,icon:"money-check-dollar",action:"Buy",className:l().adminButton,children:"Buy an activation key"})})]},e)}))]})]})]}),(0,r.jsx)(A,{isOpened:g,hasClose:!0,onClose:function(){p(!1)},title:"Payment for an activation key",children:(0,r.jsxs)("div",{className:"jsx-8b00dd331cd61514 buyKeyModal",children:[(0,r.jsx)(C(),{id:"8b00dd331cd61514",children:".buyKeyModal.jsx-8b00dd331cd61514{padding:10px}.buyKeyModal.jsx-8b00dd331cd61514 A.jsx-8b00dd331cd61514{display:block;padding:5px;color:#abd4ff;font-weight:bold}.buyKeyModal.jsx-8b00dd331cd61514 A.jsx-8b00dd331cd61514:hover{color:#fff}"}),(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514",children:"You can use this links to buy crypto with a bank card:"}),(0,r.jsxs)("a",{href:"https://changelly.com/buy/".concat(u.nativeCurrency.symbol),target:"_blank",rel:"noreferrer",className:"jsx-8b00dd331cd61514 link paymentLink",children:["Buy ",u.nativeCurrency.symbol," on Changelly"]}),(0,r.jsxs)("a",{href:"https://www.binance.com/en/buy-".concat(u.nativeCurrency.binancePurchaseKey||u.nativeCurrency.symbol),target:"_blank",rel:"noreferrer",className:"jsx-8b00dd331cd61514 link paymentLink",children:["Buy ",u.nativeCurrency.symbol," on Binance"]}),(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514 notice",children:"The price may vary slightly"}),(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("p",{className:"jsx-8b00dd331cd61514 warning",children:"Do not leave this page until successful payment. If you have any problems with the payment, please contact us."})}),W&&(0,r.jsxs)("p",{className:"jsx-8b00dd331cd61514 error",children:["Error: ",W]}),(0,r.jsxs)("button",{disabled:Z,onClick:H,className:"jsx-8b00dd331cd61514 "+(l().adminButton||""),children:[(0,r.jsx)(y,{icon:"money-check-dollar"}),F?(0,r.jsx)(r.Fragment,{children:"Buy for ".concat(S," ").concat(u.nativeCurrency.symbol," (~$").concat(Number(b).toFixed(2),") ")}):(0,r.jsx)(r.Fragment,{children:"Buy for $".concat(b," (~").concat(S," ").concat(u.nativeCurrency.symbol,") ")})]})]})}),(0,r.jsx)(A,{isOpened:Y,title:"Key activation",children:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"jsx-e9ded62631f7a3b0 activateKeyBox",children:[(0,r.jsx)(C(),{id:"e9ded62631f7a3b0",children:".activateKeyBox.jsx-e9ded62631f7a3b0{text-align:center;padding:10px}.activateKeyBox.jsx-e9ded62631f7a3b0 STRONG.jsx-e9ded62631f7a3b0{display:block;padding:10px;margin:10px;border:1px solid#262936;-webkit-box-shadow:inset 0 0 7px 1px black;-moz-box-shadow:inset 0 0 7px 1px black;box-shadow:inset 0 0 7px 1px black;color:#000;background:#fff}"}),(0,r.jsx)("span",{className:"jsx-e9ded62631f7a3b0",children:"You have successfully made a payment. Now you need to save your activation key"}),(0,r.jsx)("strong",{className:"jsx-e9ded62631f7a3b0",children:f}),(0,r.jsx)(D,{chainId:"STORAGE",onClick:$,disabled:J,icon:"receipt",action:"Active key",className:l().adminButton,children:J?"Key activation...":"Activate key"})]})})})]})}}}var je=t(94360),be=t(84575),ye=function(e){return new Promise((function(n){window.setTimeout((function(){n()}),e)}))},we={main:"Main settings",gamerules:"Rules",lotterybank:"Lottery Bank",rounds:"Rounds",texts:"Edit texts",design:"Design",license:"License"},ke=(function(){var e=Object.keys(I.w5).map((function(e){return{id:I.w5[e].networkVersion,title:I.w5[e].chainName}}));e.unshift({id:0,title:"Select Blockchain"})}(),function(e){var n=(0,F.n)(),t=n.storageChainId,o=n.storageAddress,c=e.storageData,d=(e.storageIsLoading,e.isOwner),u=e.openConfirmWindow,h=e.addNotify,m=e.setDoReloadStorage,v=e.setDoReloadStorageFast,g=e.storageTexts,p=e.storageDesign,j=e.iframeHideMenu,b=(0,x.useState)(!1),y=b[0],w=b[1],k=(0,x.useState)(!1),S=k[0],N=k[1],C=(0,x.useState)(!1),A=C[0],D=C[1],R=(0,x.useState)(!1),O=R[0],L=R[1],E=function(e,n){var t=!1;try{t=e.message.replace("Internal JSON-RPC error.",""),t=JSON.parse(t)}catch(s){}switch(t&&t.message?t.message:e.message){case"execution reverted: You don't own this token!":console.log("You dont own this token");break;case"MetaMask Tx Signature: User denied transaction signature.":console.log("Transaction denied");break;case"execution reverted: ERC721: invalid token ID":console.log("Invalid token ID");break;default:console.log("Unkrnown error",e.message)}},Z=function(e){w(e)},_=function(){var e=(0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S||"".concat(y)!="".concat(t)){e.next=4;break}S.eth.getAccounts().then((function(e){D(e[0]);var n=new S.eth.Contract(je.Mt,o);H(n)})).catch((function(e){console.log(">>> initOnWeb3Ready",e),E(e)})),e.next=8;break;case 4:return e.next=6,(0,T.IC)();case 6:e.sent&&P();case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,x.useEffect)((function(){var e;e="on useEffect activeWeb3 initOnWeb3Ready",console.log(e),_()}),[S]);var P=function(){var e=(0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,T.pE)({onBeforeConnect:function(){L(!0)},onSetActiveChain:w,onConnected:function(e,n){N(n),(0,T.uK)(Z),L(!1)},onError:function(e){console.log(">>>> connectWithMetamask",e),E(e),L(!1)},needChainId:t});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=(0,x.useState)(!1),M=W[0],H=W[1],K=(0,x.useState)(!1),V=K[0],Y=K[1],z=function(){var e=(0,s.Z)(i().mark((function e(n){var o,r,l,d,f,m,x;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.onBegin,r=n.onReady,l=n.onError,d=n.newData,!V){e.next=4;break}return h("Storage already saving...","error"),e.abrupt("return");case 4:f=(0,a.Z)({},c,d),m=function(){var e=(0,s.Z)(i().mark((function e(){var n,t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!A||!M){e.next=19;break}return h("Saving config to storage. Confirm transaction"),Y(!0),o&&o(),n=f,e.prev=5,e.next=8,(0,$.A)(A,M,"setKeyData",[(0,be.Z)(),{owner:A,info:JSON.stringify(n)}]);case 8:t=e.sent,M.methods.setKeyData((0,be.Z)(),{owner:A,info:JSON.stringify(n)}).send(t).then((function(){Y(!1),v(!0),r&&r()})).catch((function(e){console.log(">>> error",e),Y(!1),l&&l(e)})),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(5),console.log(">>> error",e.t0),Y(!1),l&&l(e.t0);case 17:e.next=20;break;case 19:h("Fail save storage. No active wallet or contract not ready yet","error");case 20:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(){return e.apply(this,arguments)}}(),console.log(">> do save",(0,T.BV)()!==t,(0,T.BV)(),t),(0,T.BV)(t)?m():(x=(0,I.T_)(t),u({title:"Need change active chain for save main config",message:"Please change network Storage chain (".concat(x.chainName,")"),onConfirm:(0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h("Switching to Storage chain"),e.next=3,(0,T.M5)(t);case 3:return e.next=5,ye(2e3);case 5:m();case 6:case"end":return e.stop()}}),e)}))),okLabel:"Switch"}));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),J=c&&!c.isInstalled,q=(0,x.useState)(!J),X=q[0],Q=q[1],ee=(0,x.useState)(!1),ne=ee[0],te=ee[1],se=(0,x.useState)("main"),oe=se[0],re=se[1],de=(0,x.useState)((null===c||void 0===c?void 0:c.chainId)||0),ue=(de[0],de[1]);(0,x.useEffect)((function(){c&&ue(c.chainId)}),[c]);var he=function(){var e=(0,I.T_)(y),n=(0,I.T_)(t);return(0,r.jsxs)("div",{className:l().adminActiveChainInfo,children:[(0,r.jsxs)("span",{children:["Current active network is ",(0,r.jsxs)("b",{children:[(null===e||void 0===e?void 0:e.chainName)||"Unknown"," (",y,")"]})]}),(0,r.jsxs)("span",{children:["Main config storage network is ",(0,r.jsxs)("b",{children:[(null===n||void 0===n?void 0:n.chainName)||"Unknown"," (",t,")"]})]})]})},fe={setDoReloadStorage:m,setDoReloadStorageFast:v,saveStorageConfig:z,openConfirmWindow:u,addNotify:h,getActiveChain:function(){return{activeAccount:A,activeChainId:y,activeWeb3:S}},storageChainId:t,storageData:c,getStorageData:function(){return c},storageDesign:p,storageTexts:g},me=new U(fe),ve=new G(fe),xe=new ae(fe),ke=new ie(fe),Se=new B(fe),Ne=new ce(fe),Ce=new pe(fe);return X&&(J=!1),(0,r.jsxs)("div",{className:l().container,children:[!j&&f("settings",!0),(0,r.jsx)("h1",{className:l().h1,children:"Settings"}),null!==c&&(0,r.jsx)(r.Fragment,{children:J?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{children:"Application need setup on this domain"}),A?(0,r.jsxs)(r.Fragment,{children:[he(),(0,r.jsx)("button",{disabled:ne,className:"".concat(l().mainButton," ").concat(l().autoWidth," primaryButton"),onClick:function(){ge({msg:"Installing lottery from ".concat(A),status:le.attention}),z({onBegin:function(){te(!0),h("Confirm transaction for setup Lottery on this domain")},onReady:(0,s.Z)(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:te(!1),Q(!0),h("Lottery successfull installed on this domain. Now you can configure farm","success"),m(!0),ge({msg:"Lottery installed at domain (".concat(A,")"),status:le.success});case 5:case"end":return e.stop()}}),e)}))),onError:function(e){te(!1),h("Fail setup Lottery on domain","error")},newData:{isInstalled:!0}})},children:ne?"Setup on domain...":"Setup Lottery on this domain"})]}):(0,r.jsx)("button",{disabled:O,className:"".concat(l().mainButton," primaryButton"),onClick:P,children:O?"Connecting":"Connect Wallet"})]}):(0,r.jsx)(r.Fragment,{children:A?(0,r.jsx)(r.Fragment,{children:d?(0,r.jsxs)(r.Fragment,{children:[he(),(0,r.jsx)("ul",{className:l().settingsTabsNav,children:Object.keys(we).map((function(e){return(0,r.jsx)("li",{onClick:function(){re(e)},className:e===oe?l().activeTab:"",children:we[e]},e)}))}),(0,r.jsx)("hr",{className:"".concat(l().divider," ").concat(l().spacerTop)}),"main"===oe&&me.render(),"gamerules"===oe&&ve.render(),"lotterybank"===oe&&Ne.render(),"rounds"===oe&&xe.render(),"texts"===oe&&ke.render(),"design"===oe&&Se.render(),"license"===oe&&Ce.render()]}):(0,r.jsx)("h2",{children:"Access denied"})}):(0,r.jsx)("button",{disabled:O,className:"".concat(l().mainButton," primaryButton"),onClick:P,children:O?"Connecting":"Connect Wallet"})})})]})})}},function(e){e.O(0,[976,131,774,888,179],(function(){return n=52837,e(e.s=n);var n}));var n=e.O();_N_E=n}]);